# Java并发编程学习笔记

### 目的

提高程序的性能，包括处理吞吐率，响应性，提高硬件的使用效率。

### 宏观

并发编程可分为分工，同步，互斥

### 存在的问题

- 线程安全 （原子性，有序性， 可见性）
- 竞条（条件竞态，数据竞态）
- 上下文切换
- 线程活性问题(死锁，锁死， 活锁， 饥饿)
- 资源争用和调度(公平调度， 非公司调度)

### 锁

#### 作用

能够保护共享数据以实现线程安全，包括保障原子性，可见性和有序性， 从宏观上将多个线程的并发访问改为了串行，会降低系统性能. 

#### 分类

内部锁synchronized, 显示锁Lock, 读写锁

#### 特征

可重入性， 粒度

#### 使用

关键要分析清楚锁和资源的关系，使用合适的锁粒度

如果资源之间没有关系，很好处理，每个资源一把锁就可以了。如果资源之间有关联关系，就要选择一个粒度更大的锁，这个锁应该能够覆盖所有相关的资源。除此之外，还要梳理出有哪些访问路径，所有的访问路径都要设置合适的锁，这个过程可以类比一下门票管理。

#### 问题

锁的争用与调度(公平与非公平), 上下文切换，活性故障

#### 原则

锁，应是私有的、不可变的、不可重用的。